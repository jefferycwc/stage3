/*
 * NRF NFManagement Service
 *
 * NRF NFManagement Service
 *
 * API version: 1.0.0
 * Generated by: OpenAPI Generator (https://openapi-generator.tech)
 */

package management

import (
	"fmt"
	"free5gc/lib/MongoDBLibrary"
	"free5gc/src/nrf/urilist"
	"net/http"
	"strconv"

	"github.com/gin-gonic/gin"
	"github.com/mitchellh/mapstructure"
	"go.mongodb.org/mongo-driver/bson"
)

// GetNFInstances - Retrieves a collection of NF Instances
func GetNFInstances(c *gin.Context) {

	nfType := c.Query("nf-type")
	//limit := c.Query("limit")
	limit, err := strconv.Atoi(c.Query("limit"))
	fmt.Println("limit.........", limit)
	collName := "urilist"
	filter := bson.M{"nfType": nfType}

	UL := MongoDBLibrary.RestfulAPIGetOne(collName, filter)

	var originalUL urilist.UriList
	err2 := mapstructure.Decode(UL, &originalUL)
	if err2 != nil {
		panic(err)
	}
	nnrfUriListLimit(&originalUL, limit)
	c.JSON(http.StatusOK, originalUL)
}
